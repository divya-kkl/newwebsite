<!-- <!-- 
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard - Login App</title>
  <style>
   /* Page heading */
h2 {
  text-align: center;
  color: #333;
  margin: 1.5rem 0;
  font-size: 1.6rem;
  font-weight: 600;
}

/* Table container */
#usersTable {
  width: 90%;
  max-width: 800px;
  margin: 0 auto;
  border-collapse: collapse;
  background: #fff;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

/* Table header */
#usersTable thead {
  background: #4a90e2;
  color: #fff;
  font-weight: 600;
}

#usersTable th {
  padding: 1rem;
  text-align: left;
  font-size: 1rem;
  letter-spacing: 0.5px;
}

/* Table rows */
#usersTable td {
  padding: 0.9rem 1rem;
  border-bottom: 1px solid #eee;
  font-size: 0.95rem;
  color: #333;
}

/* Row hover effect */
#usersTable tbody tr:hover {
  background: #f9fbff;
  transition: background 0.3s;
}

/* Loading message cell */
#usersTable td[colspan="3"] {
  text-align: center;
  font-style: italic;
  color: #777;
}

/* Responsive table */
@media (max-width: 600px) {
  #usersTable th,
  #usersTable td {
    padding: 0.7rem;
    font-size: 0.9rem;
  }
}

  </style>
</head>
<body>
  <h2>All Saved Users</h2>

  <table id="usersTable">
    <thead>
      <tr><th>Name</th><th>Email</th><th>Password</th></tr>
    </thead>
    <tbody id="usersBody">
      <tr><td colspan="3" style="text-align:center">Loading users...</td></tr>
    </tbody>
  </table>

 <p class="center"><a href="/signup.html">Go to Signup</a></p> -->

  <!-- <script>
    async function loadUsers() {
      const body = document.getElementById('usersBody');
      body.innerHTML = '<tr><td colspan="3" style="text-align:center">Loading users...</td></tr>';
      try {
        const res = await fetch('/api/users');
        if (!res.ok) throw new Error('Failed to fetch users');
        const users = await res.json();
        if (!Array.isArray(users) || users.length === 0) {
          body.innerHTML = '<tr><td colspan="3" style="text-align:center">No users found</td></tr>';
          return;
        }
        body.innerHTML = '';
        users.forEach(u => {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${escapeHtml(u.name)}</td><td>${escapeHtml(u.email)}</td><td>${escapeHtml(u.password)}</td>`;
          body.appendChild(tr);
        });
      } catch (err) {
        body.innerHTML = '<tr><td colspan="3" style="text-align:center">Error loading users</td></tr>';
      }
    }

    function escapeHtml(str) {
      return String(str || '')
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
    }

    loadUsers();
    setInterval(loadUsers, 6000); // refresh every 6s
  </script>
</body>
</html> --> 


<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard - Login App</title>
  <style>
   /* Page heading */
h2 {
  text-align: center;
  color: #333;
  margin: 1.5rem 0;
  font-size: 1.6rem;
  font-weight: 600;
}

/* Table container */
#usersTable {
  width: 90%;
  max-width: 800px;
  margin: 0 auto;
  border-collapse: collapse;
  background: #fff;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

/* Table header */
#usersTable thead {
  background: #4a90e2;
  color: #fff;
  font-weight: 600;
}

#usersTable th {
  padding: 1rem;
  text-align: left;
  font-size: 1rem;
  letter-spacing: 0.5px;
}

/* Table rows */
#usersTable td {
  padding: 0.9rem 1rem;
  border-bottom: 1px solid #eee;
  font-size: 0.95rem;
  color: #333;
}

/* Row hover effect */
#usersTable tbody tr:hover {
  background: #f9fbff;
  transition: background 0.3s;
}

/* Loading message cell */
#usersTable td[colspan] {
  text-align: center;
  font-style: italic;
  color: #777;
}

/* Delete button */
.delete-btn {
  background: #e74c3c;
  color: #fff;
  border: none;
  padding: 0.4rem 0.8rem;
  border-radius: 6px;
  cursor: pointer;
  font-size: 0.85rem;
  transition: background 0.3s;
}

.delete-btn:hover {
  background: #c0392b;
}

/* Responsive table */
@media (max-width: 600px) {
  #usersTable th,
  #usersTable td {
    padding: 0.7rem;
    font-size: 0.9rem;
  }
}
  </style>
</head>
<body>
  <h2>All Saved Users</h2>

  <table id="usersTable">
    <thead>
      <tr><th>Name</th><th>Email</th><th>Password</th><th>Action</th></tr>
    </thead>
    <tbody id="usersBody">
      <tr><td colspan="4" style="text-align:center">Loading users...</td></tr>
    </tbody>
  </table>

  <script>
    async function loadUsers() {
      const body = document.getElementById('usersBody');
      body.innerHTML = '<tr><td colspan="4" style="text-align:center">Loading users...</td></tr>';
      try {
        const res = await fetch('/api/users');
        if (!res.ok) throw new Error('Failed to fetch users');
        const users = await res.json();
        if (!Array.isArray(users) || users.length === 0) {
          body.innerHTML = '<tr><td colspan="4" style="text-align:center">No users found</td></tr>';
          return;
        }
        body.innerHTML = '';
        users.forEach(u => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${escapeHtml(u.name)}</td>
            <td>${escapeHtml(u.email)}</td>
            <td>${escapeHtml(u.password)}</td>
            <td><button class="delete-btn" onclick="deleteUser('${u.id}')">Delete</button></td>
          `;
          body.appendChild(tr);
        });
      } catch (err) {
        body.innerHTML = '<tr><td colspan="4" style="text-align:center">Error loading users</td></tr>';
      }
    }

    async function deleteUser(id) {
      if (!confirm("Are you sure you want to delete this user?")) return;
      try {
        const res = await fetch(`/api/users/${id}`, { method: 'DELETE' });
        if (!res.ok) throw new Error('Failed to delete user');
        loadUsers(); // refresh list
      } catch (err) {
        alert("Error deleting user");
      }
    }

    function escapeHtml(str) {
      return String(str || '')
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
    }

    loadUsers();
    setInterval(loadUsers, 6000); // refresh every 6s
  </script>
</body>
</html> -->



<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard - Login App</title>
  <style>
    /* Page heading */
    h2 {
      text-align: center;
      color: #333;
      margin: 1.5rem 0;
      font-size: 1.6rem;
      font-weight: 600;
    }

    /* Table container */
    #usersTable {
      width: 90%;
      max-width: 800px;
      margin: 0 auto;
      border-collapse: collapse;
      background: #fff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    /* Table header */
    #usersTable thead {
      background: #4a90e2;
      color: #fff;
      font-weight: 600;
    }

    #usersTable th {
      padding: 1rem;
      text-align: left;
      font-size: 1rem;
      letter-spacing: 0.5px;
    }

    /* Table rows */
    #usersTable td {
      padding: 0.9rem 1rem;
      border-bottom: 1px solid #eee;
      font-size: 0.95rem;
      color: #333;
    }

    /* Row hover effect */
    #usersTable tbody tr:hover {
      background: #f9fbff;
      transition: background 0.3s;
    }

    /* Loading message cell */
    #usersTable td[colspan] {
      text-align: center;
      font-style: italic;
      color: #777;
    }

    /* Delete button */
    .delete-btn {
      background: #e74c3c;
      color: #fff;
      border: none;
      padding: 0.4rem 0.8rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.85rem;
      transition: background 0.3s;
    }

    .delete-btn:hover {
      background: #c0392b;
    }

    /* Responsive table */
    @media (max-width: 600px) {
      #usersTable th,
      #usersTable td {
        padding: 0.7rem;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <h2>All Saved Users</h2>

  <table id="usersTable">
    <thead>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Password</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="usersBody">
      <tr><td colspan="4" style="text-align:center">Loading users...</td></tr>
    </tbody>
  </table>

  <script>
    async function loadUsers() {
      const body = document.getElementById('usersBody');
      body.innerHTML = '<tr><td colspan="4" style="text-align:center">Loading users...</td></tr>';

      try {
        const res = await fetch('/api/users');
        if (!res.ok) throw new Error('Failed to fetch users');

        const users = await res.json();

        if (!Array.isArray(users) || users.length === 0) {
          body.innerHTML = '<tr><td colspan="4" style="text-align:center">No users found</td></tr>';
          return;
        }

        body.innerHTML = '';
        users.forEach(u => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${escapeHtml(u.name)}</td>
            <td>${escapeHtml(u.email)}</td>
            <td>${escapeHtml(u.password)}</td>
            <td><button class="delete-btn">Delete</button></td>
          `;

          // Attach delete event safely
          tr.querySelector('.delete-btn').addEventListener('click', () => deleteUser(u.id));

          body.appendChild(tr);
        });
      } catch (err) {
        console.error(err);
        body.innerHTML = '<tr><td colspan="4" style="text-align:center">Error loading users</td></tr>';
      }
    }

    async function deleteUser(id) {
      if (!confirm("Are you sure you want to delete this user?")) return;

      try {
        const res = await fetch(`/api/users/${encodeURIComponent(id)}`, { method: 'DELETE' });
        if (!res.ok) throw new Error('Failed to delete user');
        loadUsers(); // Refresh list
      } catch (err) {
        console.error(err);
        alert("Error deleting user");
      }
    }

    function escapeHtml(str) {
      return String(str || '')
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
    }

    // Initial load
    loadUsers();
    // Refresh every 6 seconds
    setInterval(loadUsers, 6000);
  </script>
</body>
</html> -->


<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard - Login App</title>
  <style>
    h2 {
      text-align: center;
      color: #333;
      margin: 1.5rem 0;
      font-size: 1.6rem;
      font-weight: 600;
    }

    #usersTable {
      width: 90%;
      max-width: 800px;
      margin: 0 auto;
      border-collapse: collapse;
      background: #fff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    #usersTable thead {
      background: #4a90e2;
      color: #fff;
      font-weight: 600;
    }

    #usersTable th {
      padding: 1rem;
      text-align: left;
      font-size: 1rem;
      letter-spacing: 0.5px;
    }

    #usersTable td {
      padding: 0.9rem 1rem;
      border-bottom: 1px solid #eee;
      font-size: 0.95rem;
      color: #333;
    }

    #usersTable tbody tr:hover {
      background: #f9fbff;
      transition: background 0.3s;
    }

    #usersTable td[colspan] {
      text-align: center;
      font-style: italic;
      color: #777;
    }

    .delete-btn {
      background: #e74c3c;
      color: #fff;
      border: none;
      padding: 0.4rem 0.8rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.85rem;
      transition: background 0.3s;
    }

    .delete-btn:hover {
      background: #c0392b;
    }

    @media (max-width: 600px) {
      #usersTable th,
      #usersTable td {
        padding: 0.7rem;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <h2>All Saved Users</h2>

  <table id="usersTable">
    <thead>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Password</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="usersBody">
      <tr><td colspan="4" style="text-align:center">Loading users...</td></tr>
    </tbody>
  </table>

  <script>
    // Escape HTML to prevent breaking the table
    function escapeHtml(str) {
      return String(str || '')
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
    }

    // Load users from backend
    async function loadUsers() {
      const body = document.getElementById('usersBody');
      body.innerHTML = '<tr><td colspan="4" style="text-align:center">Loading users...</td></tr>';

      try {
        const res = await fetch('/api/users'); // Make sure your backend has this endpoint
        if (!res.ok) throw new Error(`Failed to fetch users: ${res.status}`);
        const users = await res.json();

        if (!Array.isArray(users) || users.length === 0) {
          body.innerHTML = '<tr><td colspan="4" style="text-align:center">No users found</td></tr>';
          return;
        }

        body.innerHTML = '';

        users.forEach(u => {
          const tr = document.createElement('tr');

          tr.innerHTML = `
            <td>${escapeHtml(u.name)}</td>
            <td>${escapeHtml(u.email)}</td>
            <td>${escapeHtml(u.password)}</td>
            <td><button class="delete-btn">Delete</button></td>
          `;

          // Attach delete event safely
          tr.querySelector('.delete-btn').addEventListener('click', () => deleteUser(u.id));

          body.appendChild(tr);
        });

      } catch (err) {
        console.error(err);
        body.innerHTML = '<tr><td colspan="4" style="text-align:center">Error loading users</td></tr>';
      }
    }

    // Delete a user by ID
    async function deleteUser(id) {
      console.log("Deleting user ID:", id);

      if (!confirm("Are you sure you want to delete this user?")) return;

      try {
        const res = await fetch(`/api/users/${encodeURIComponent(id)}`, { method: 'DELETE' });
        console.log("Response status:", res.status);

        if (!res.ok) {
          const errorText = await res.text();
          throw new Error(`Failed to delete user: ${errorText}`);
        }

        loadUsers(); // Refresh the table

      } catch (err) {
        console.error(err);
        alert(`Error deleting user: ${err.message}`);
      }
    }

    // Initial load and periodic refresh
    loadUsers();
    setInterval(loadUsers, 1000);
  </script>
</body>
</html> -->

<!-- 
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard - Login App</title>
  <style>
    h2 {
      text-align: center;
      color: #333;
      margin: 1.5rem 0;
      font-size: 1.6rem;
      font-weight: 600;
    }

    #usersTable {
      width: 90%;
      max-width: 800px;
      margin: 0 auto;
      border-collapse: collapse;
      background: #fff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    #usersTable thead {
      background: #4a90e2;
      color: #fff;
      font-weight: 600;
    }

    #usersTable th {
      padding: 1rem;
      text-align: left;
      font-size: 1rem;
      letter-spacing: 0.5px;
    }

    #usersTable td {
      padding: 0.9rem 1rem;
      border-bottom: 1px solid #eee;
      font-size: 0.95rem;
      color: #333;
    }

    #usersTable tbody tr:hover {
      background: #f9fbff;
      transition: background 0.3s;
    }

    #usersTable td[colspan] {
      text-align: center;
      font-style: italic;
      color: #777;
    }

    .action-btn {
      padding: 0.3rem 0.7rem;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-size: 0.85rem;
      margin-right: 5px;
      transition: background 0.3s;
    }

    .delete-btn { background: #e74c3c; color: #fff; }
    .delete-btn:hover { background: #c0392b; }
    .edit-btn { background: #3498db; color: #fff; }
    .edit-btn:hover { background: #2980b9; }
    .save-btn { background: #2ecc71; color: #fff; }
    .save-btn:hover { background: #27ae60; }
    .cancel-btn { background: #95a5a6; color: #fff; }
    .cancel-btn:hover { background: #7f8c8d; }

    input.edit-input {
      width: 95%;
      padding: 2px 4px;
      font-size: 0.9rem;
    }

    @media (max-width: 600px) {
      #usersTable th, #usersTable td {
        padding: 0.7rem;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <h2>All Saved Users</h2>
  <table id="usersTable">
    <thead>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Password</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="usersBody">
      <tr><td colspan="4" style="text-align:center">Loading users...</td></tr>
    </tbody>
  </table>

  <script>
    function escapeHtml(str) {
      return String(str || '')
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
    }

    async function loadUsers() {
      const body = document.getElementById('usersBody');
      body.innerHTML = '<tr><td colspan="4" style="text-align:center">Loading users...</td></tr>';

      try {
        const res = await fetch('/api/users');
        if (!res.ok) throw new Error(`Failed to fetch users: ${res.status}`);
        const users = await res.json();

        if (!Array.isArray(users) || users.length === 0) {
          body.innerHTML = '<tr><td colspan="4" style="text-align:center">No users found</td></tr>';
          return;
        }

        body.innerHTML = '';
        users.forEach(u => {
          const tr = document.createElement('tr');
          tr.dataset.id = u.id;

          tr.innerHTML = `
            <td class="name">${escapeHtml(u.name)}</td>
            <td class="email">${escapeHtml(u.email)}</td>
            <td class="password">${escapeHtml(u.password)}</td>
            <td>
              <button class="action-btn edit-btn">Edit</button>
              <button class="action-btn delete-btn">Delete</button>
            </td>
          `;

          tr.querySelector('.delete-btn').addEventListener('click', () => deleteUser(u.id));
          tr.querySelector('.edit-btn').addEventListener('click', () => startEdit(tr, u));

          body.appendChild(tr);
        });
      } catch (err) {
        console.error(err);
        body.innerHTML = '<tr><td colspan="4" style="text-align:center">Error loading users</td></tr>';
      }
    }

    async function deleteUser(id) {
      if (!confirm("Are you sure you want to delete this user?")) return;
      try {
        const res = await fetch(`/api/users/${encodeURIComponent(id)}`, { method: 'DELETE' });
        if (!res.ok) throw new Error(`Failed to delete user: ${res.status}`);
        loadUsers();
      } catch (err) {
        console.error(err);
        alert(`Error deleting user: ${err.message}`);
      }
    }

    function startEdit(tr, user) {
      tr.querySelector('.name').innerHTML = `<input class="edit-input name-input" value="${escapeHtml(user.name)}">`;
      tr.querySelector('.email').innerHTML = `<input class="edit-input email-input" value="${escapeHtml(user.email)}">`;
      tr.querySelector('.password').innerHTML = `<input class="edit-input password-input" value="${escapeHtml(user.password)}">`;

      const actionCell = tr.querySelector('td:last-child');
      actionCell.innerHTML = `
        <button class="action-btn save-btn">Save</button>
        <button class="action-btn cancel-btn">Cancel</button>
      `;

      actionCell.querySelector('.save-btn').addEventListener('click', () => saveEdit(tr, user.id));
      actionCell.querySelector('.cancel-btn').addEventListener('click', () => loadUsers());
    }

    async function saveEdit(tr, id) {
      const name = tr.querySelector('.name-input').value.trim();
      const email = tr.querySelector('.email-input').value.trim();
      const password = tr.querySelector('.password-input').value.trim();

      try {
        const res = await fetch(`/api/users/${encodeURIComponent(id)}`, {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name, email, password })
        });
        if (!res.ok) throw new Error(`Failed to update user: ${res.status}`);
        loadUsers();
      } catch (err) {
        console.error(err);
        alert(`Error updating user: ${err.message}`);
      }
    }

    loadUsers();
    setInterval(loadUsers, 1000);
  </script>
</body>
</html> -->


<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Dashboard</title>
<style>
body { font-family:sans-serif; }
h2 { text-align:center; }
table { width:90%; max-width:800px; margin:auto; border-collapse:collapse; }
th, td { border:1px solid #ccc; padding:0.6rem; }
tr:hover { background:#f0f8ff; }
input { padding:2px; width:95%; }
.action-btn { padding:3px 7px; margin-right:4px; cursor:pointer; border:none; border-radius:5px; }
.edit-btn { background:#afb0b1; color:white;}
.delete-btn { background:#6d6c6c; color:white; }
.save-btn { background:#2ecc71; color:white; }
.cancel-btn { background:#95a5a6; color:white; }
.add-btn { background:#27ae60; color:white; margin-bottom:10px; }

@media (max-width: 800px) {
    table, th, td {
        font-size: 0.9rem; /* slightly smaller text */
    }
    
    input {
        width: 100%; /* full width inputs on small screens */
    }
    
    .action-btn {
        padding: 5px 10px; /* slightly larger clickable buttons for touch */
        margin-bottom: 4px;
    }

    table {
        display: block;
        overflow-x: auto; /* horizontal scroll for small screens */
    }
}
</style>
</head>
<body>

<h2>Admin Dashboard</h2>

<!-- <div style="text-align:center; margin-bottom:10px;">
<input id="newName" placeholder="Name">
<input id="newEmail" placeholder="Email">
<input id="newPassword" placeholder="Password">
<button class="add-btn" onclick="addUser()">Add User</button>
</div> -->

<table>
<thead>
<tr><th>Name</th><th>Email</th><th>Password</th><th>Action</th></tr>
</thead>
<tbody id="usersBody">
<tr><td colspan="4" style="text-align:center">Loading...</td></tr>
</tbody>
</table>

<script>
const API_URL = '/api/users';

function escapeHtml(str) {
    return String(str || '').replace(/&/g,'&amp;').replace(/</g,'&lt;')
                            .replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;');
}

// Load all users
async function loadUsers() {
    const body = document.getElementById('usersBody');
    body.innerHTML = '<tr><td colspan="4" style="text-align:center">Loading...</td></tr>';
    try {
        const res = await fetch(API_URL);
        const users = await res.json();
        body.innerHTML = '';
        users.forEach(u => {
            const tr = document.createElement('tr');
            tr.dataset.id = u._id;
            tr.innerHTML = `
            <td class="name">${escapeHtml(u.name)}</td>
            <td class="email">${escapeHtml(u.email)}</td>
            <td class="password">${escapeHtml(u.password)}</td>
            <td>
                <button class="action-btn edit-btn">Edit</button>
                <button class="action-btn delete-btn">Delete</button>
            </td>`;
            tr.querySelector('.delete-btn').addEventListener('click',()=>deleteUser(u._id));
            tr.querySelector('.edit-btn').addEventListener('click',()=>startEdit(tr,u));
            body.appendChild(tr);
        });
    } catch(err){
        body.innerHTML = '<tr><td colspan="4" style="text-align:center">Error loading users</td></tr>';
    }
}

// Add new user
async function addUser() {
    const name = document.getElementById('newName').value.trim();
    const email = document.getElementById('newEmail').value.trim();
    const password = document.getElementById('newPassword').value.trim();
    if(!name || !email || !password){ alert('Fill all fields'); return; }
    try{
        await fetch(API_URL,{method:'POST', headers:{'Content-Type':'application/json'},
            body: JSON.stringify({name,email,password})});
        document.getElementById('newName').value='';
        document.getElementById('newEmail').value='';
        document.getElementById('newPassword').value='';
        loadUsers();
    } catch(err){ alert(err.message); }
}

// Delete user
async function deleteUser(id){
    if(!confirm('Delete this user?')) return;
    try{ await fetch(`${API_URL}/${id}`,{method:'DELETE'}); loadUsers(); }
    catch(err){ alert(err.message); }
}

// Edit user
function startEdit(tr,user){
    tr.querySelector('.name').innerHTML=`<input value="${escapeHtml(user.name)}">`;
    tr.querySelector('.email').innerHTML=`<input value="${escapeHtml(user.email)}">`;
    tr.querySelector('.password').innerHTML=`<input value="${escapeHtml(user.password)}">`;
    const cell = tr.querySelector('td:last-child');
    cell.innerHTML=`<button class="save-btn">Save</button><button class="cancel-btn">Cancel</button>`;
    cell.querySelector('.save-btn').addEventListener('click',()=>saveEdit(tr,user._id));
    cell.querySelector('.cancel-btn').addEventListener('click',()=>loadUsers());
}

// Save edited user
async function saveEdit(tr,id){
    const name = tr.querySelector('td:nth-child(1) input').value.trim();
    const email = tr.querySelector('td:nth-child(2) input').value.trim();
    const password = tr.querySelector('td:nth-child(3) input').value.trim();
    try{
        await fetch(`${API_URL}/${id}`,{
            method:'PUT',
            headers:{'Content-Type':'application/json'},
            body: JSON.stringify({name,email,password})
        });
        loadUsers();
    } catch(err){ alert(err.message); }
}

// Initial load
loadUsers();
</script>
</body>
</html> 
